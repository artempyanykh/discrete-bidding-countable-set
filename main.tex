%% -*- coding: cp1251; -*-
\documentclass[11pt, draft]{ubs}

\usepackage{graphicx}

\issue{XX}% Выпуск Сборника - проставляется в процессе верстки
\rubric{Системный анализ}% Рубрика Сборника - может быть скорректирована редактором
%
% Имеющиеся рубрики (последнюю информацию см. на сайте ubs.mtas.ru):
%
%    Системный анализ
%    Математическая теория управления
%    Анализ и синтез систем управления
%    Информационные технологии в управлении
%    Управление в социально-экономических системах
%    Управление в медико-биологических и экологических системах
%    Управление техническими системами и технологическими процессами
%    Управление подвижными объектами и навигация
%    Технические и программные средства управления
%    Надежность и диагностика средств и систем управления
%    Программы и системы моделирования объектов, средств и систем управления

%    В соответствии с требованиями ВАК коды УДК и ББК обязательны. Проставляются
%    автором. Могут быть скорректированы редактором
\udk{УДК 519.83}
\bbk{ББК 22.18}

\title{Многошаговая модифицированная модель биржевой игры со счетным множеством состояний}

\engtitle{Multistage modified bidding model with a countable set of states}

\thanks{\footnote{%
    Исследование выполнено при финансовой поддержке РФФИ в рамках научного
    проекта №16-01-00353a. %
    Автор признателен своему научному руководителю к.ф.-м.н., доценту
    В.В.~Морозову за помощь в написании данной статьи.%
}}

\authors{%
  \textbf{Пьяных~А.И.}\footnote{Артем Игоревич Пьяных, аспирант
    (artem.pyanykh@gmail.com).}\\
  \textit{(Московский государственный университет имени М.В.~Ломоновосова,
    Москва)}%
}
%
\engauthors{%
  \textbf{Artem Pyanykh}, Lomonosov Moscow State University, Moscow,
  post-graduate student (artem.pyanykh@gmail.ru).%
}

\abstract{
  Рассматривается упрощенная модель финансового рынка, на котором два игрока ведут торговлю однотипными акциями в течение $n$ шагов.
  Игрок 1 (инсайдер) информирован о настоящей ликвидной цене акции, которая может принимать любое значение из $\Z_+$.
  В то же время игрок 2 знает только вероятностное распределение $\p$ цены акции и то, что первый игрок --- инсайдер.
  На каждом шаге торгов игроки делают целочисленные ставки.
  Игрок, предложивший б\'{о}льшую ставку, покупает у другого акцию по цене, равной выпуклой комбинации предложенных ставок с некоторым коэффициентом $\beta$.
  После каждого хода сделанные ставки оглашаются игрокам.
  Получено решение повторяющейся игры неограниченной продолжительности, отвечающей данной модели, для распределений $\p$ с конечной дисперсией.
}
\engabstract{%
  A simplified financial market model with two players bidding for one unit of a risky asset for $n$ consequtive stages is considered.
  Player 1 (an insider) is informed about the liquidation price of the asset which can take any value in $\Z_+$.
  At the same time Player 2 knows only probability distribution $\p$ of the price and that Player 1 is an insider.
  At each bidding stage players place integer bids.
  The higher bid wins and one unit of the asset is transacted to the winning player at the cost equal to a convex combination of the bids with some coefficient $\beta$.
  After each stage the bids are announced to the players.
  A solution to an infinitely long game corresponding to the described model is obtained for distributions $\p$ with a finite variation.%
}

\keywords{многошаговые игры, асимметричная информация, инсайдерская торговля}
\engkeywords{repeated games, asymmetric information, insider trading}

\presented{...}% Член редколлегии, представляющий статью к публикации,
               % заполняется редактором, например, Ивановым А.А.
\received{...}% Дата получения материала редакционной коллегией - может
              % корректироваться редактором
\published{...}% Дата опубликования статьи, заполняется редактором

\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows}
\usetikzlibrary{automata}

\usepackage{xcolor}
\newcommand{\todo}[1]{\textcolor{red}{#1}}

\newcommand{\overbar}[1]%
{\mkern 1.5mu\overline{\mkern-1.3mu#1\mkern-1.3mu}\mkern 1.3mu}

\newcommand{\as}[1][\beta]{\ensuremath{a^{s,#1}}}
\newcommand{\s}{\ensuremath{s}}
\newcommand{\p}{\ensuremath{\overbar{p}}}
\newcommand{\q}{\ensuremath{\overbar{q}}}
\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\D}{\mathbb{D}}
\DeclareMathOperator{\Z}{\mathbb{Z}}
\newcommand{\G}[1][n]{\ensuremath{G^\beta_{#1}}}
\newcommand{\K}[1][n]{\ensuremath{K^\beta_{#1}}}
\DeclareMathOperator{\FPStrategies}{\Sigma}
\DeclareMathOperator{\SPStrategies}{\mathrm{T}}
\newcommand{\V}[1][n]{\ensuremath{V^\beta_{#1}}}
\newcommand{\High}[1][\ensuremath{\infty}]{\ensuremath{H^\beta_{#1}}}
\newcommand{\sigmav}{\ensuremath{\overbar{\sigma}}}
\newcommand{\tauv}{\ensuremath{\overbar{\tau}}}
\newcommand{\xiv}{\ensuremath{\overbar{\xi}}}
\newcommand{\sigmak}{\ensuremath{\hat{\sigma}}}
\newcommand{\Low}[1][\ensuremath{\infty}]{\ensuremath{L^\beta_{#1}}}

\begin{document}

\maketitle

\section*{Введение}
\label{sec:intro}

В данной работе рассматривается упрощенная модель финансового рынка, изученная, в частности, в работах \cite{bib:domansky07, bib:domansky11}, на котором два игрока ведут торговлю однотипными акциями на протяжении $n \leqslant \infty$ шагов.
Перед началом торгов случайный ход определяет цену акции $\s \in S$ на весь период торгов в соответствии с вероятностным распределением $\p = (p^s, \; s \in S)$.
Выбранная цена сообщается игроку 1 (инсайдеру).
Игрок 2 при этом знает только вероятностное распределение $\p$ и не осведомлен о настоящем значении цены.
Также игрок 2 знает, что игрок~1 --- инсайдер.
На каждом шаге торгов игроки одновременно и независимо назначают некоторую цену за акцию.
Игрок, сделавший б\'{о}льшую ставку, покупает акцию у другого; если ставки равны, сделки не происходит.
После каждого шага торгов сделанные ставки оглашаются игрокам.
Задачей игроков является максимизация стоимости итогового портфеля, состоящего из некоторого числа купленных акций и суммы денег, полученных в результате торгов.
Данное описание считается известным обоим игрокам.

Впервые подобная задача была рассмотрена Б.~Де~Мейером и Х.~Салей в \cite{bib:demeyer02}.
В модели, рассмотренной авторами, цена акции может принимать два значения $0$ и $1$, а игроки могут делать произвольные вещественные ставки из сегмента $[0, 1]$.
Данную модель мы будем называть непрерывной.
При помощи такой упрощенной модели торгов на финансовом рынке авторами была продемонстрирована возможность стратегического происхождения броуновского движения в эволюции цен на финансовые активы --- была получена асимптотика случайной последовательности цен сделок, порождаемых оптимальным поведением игроков, и продемонстрировано наличие в этой асимптотике винеровской компоненты.

Позднее В.К.~Доманским в \cite{bib:domansky07} была исследована модель, в рамках которой цена акции, так же, может принимать два значения $0$ и $1$, но игроки могут делать ставки только из дискретного множества $\{i/m, i = \overline{0, m}\},\ m \in \mathbb{N}$.
Данную модель мы будем называть дискретной.
Формально дискретная модель описывается повторяющейся игрой с неполной информацией (см.~\cite{bib:aumann}).
В работе~\cite{bib:domansky07} показано, что последовательность верхних значений $n$-шаговых игр ограничена, что позволяет определить и решить игру с бесконечным количеством шагов.
Установлено, что в дискретном случае при применении игроками оптимальных стратегий последовательность ожидаемых ликвидных цен акции образует симметричное случайное блуждание по множеству допустимых ставок с поглощением в крайних точках.
Момент поглощения представляет собой момент, когда оценка игроком~2 ликвидной цены акции совпадает с истинным значением этой цены.
В этот момент торги могут быть остановлены, так как последующий выигрыш игрока~1 равен нулю.

%
Для игр с конечным количеством шагов аналитические решения получены только в частных случаях: М.С.~Сандомирской и В.К.~Доманским в \cite{bib:sandomirskaya12} найдено решение одношаговой игры при произвольном натуральном значении $m$, В.Л.~Крепс в \cite{bib:kreps09} построено решение $n$-шаговых игр при $m \leqslant 3$.

В работе \cite{bib:domansky11} рассмотрено обобщение дискретной модели на случай, когда цена акции может принимать любое значение $\s \in S = \mathbb{Z}_+$.
Решение игры с бесконечным количеством шагов найдено в предположении конечности дисперсии цены акции.
Авторами установлено, что в данном случае оптимальная стратегия инсайдера так же порождает симметричное случайное блуждание цен сделок.
Поглощение при этом может произойти после каждого шага, начиная с нулевого.
Последнее происходит в ситуации, когда выбранная перед началом игры случайным ходом цена акции совпадает со своим математическим ожиданием, что невозможно для распределений с двухточечным носителем.

В указанных выше работах сделка осуществляется по цене, равной наибольшей предложенной ставке.
Можно, однако, рассмотреть другой механизм, предложенный в \cite{bib:chatterjee83}, и положить цену сделки равной выпуклой комбинации предложенных ставок с коэффициентом $\beta \in [0,1]$, т.е. если игроками были сделаны ставки $i \neq j$, то акция будет продана по цене
\[
  \beta \max(i, j) + (1-\beta) \min(i, j).
\]
Фактически, в \cite{bib:domansky07, bib:domansky11} коэффициент $\beta$ равен $1$.
Обобщение дискретной модели с двумя возможными значениями цены акции на случай $\beta = 1/2$ получено в работе \cite{bib:pyanykh14}, обобщение на случай произвольного $\beta \in [0, 1]$ построено в работе \cite{bib:pyanykh16}.

В данной работе это обобщение проведено для дискретной модели со счетным множеством возможных значений цены акции.
Установлено, что оптимальная стратегия инсайдера порождает случайное блуждание последовательности ликвидных цен акции, которое, однако, уже не является симметричным и происходит по более широкому набору множеств.
Более подробное описание возникающих в рассматриваемой модели случайных блужданий дается в п.~\ref{sec:game-solution}.
Появление случайного блуждания в более общей модели подтверждает гипотезу о возможном стратегическом происхождении случайных флуктуаций цен на фондовых рынках.

Доказательства утверждений вынесены в приложение.

\section{Постановка задачи}
\label{sec:problem-statement}

Пусть множество состояний рынка $S = \Z_+$. Перед началом игры случай выбирает состояние рынка $\s \in S$ в соответствии с вероятностным распределением $\p = (p^s, \; s \in S)$ таким, что дисперсия состояния $\D \p < \infty$.
На каждом шаге игры $t = \overline{1,n}, \; n \leqslant \infty$ игроки делают ставки $i_t \in I, \, j_t \in J$, где $I = J = \Z_+$.
В силу того, что игрок, предложивший б\'{о}льшую ставку, покупает акцию у другого по цене, равной выпуклой комбинации предложенных ставок, выплата игроку 1 в состоянии $s$ равна
\begin{equation*}
  % \label{eq:ps:stage-payoff}
  \as(i_t, j_t) =
  \begin{cases}
    (1-\beta) i_t + \beta j_t - s, &\; i_t < j_t, \\
    0, &\; i_t = j_t, \\
    s - \beta i_t - (1-\beta)j_t, &\; i_t > j_t.
  \end{cases}
\end{equation*}

На шаге $t$ обоим игрокам достаточно принимать в расчет лишь последовательность $(i_1, i_2, \ldots, i_{t-1})$ действий игрока~1 на предыдущих ходах.
Это связано с тем, что информация, получаемая игроком~2 относительно состояния $s$, может передаваться лишь посредством действий игрока~1.
Подробное обсуждение данного факта можно найти в \cite{bib:mertens15}.

Обозначим через $\Delta(X)$ совокупность всех вероятностных распределений на
множестве $X$.

\begin{definition}
  Стратегией игрока 1 является последовательность ходов $\sigmav = (\sigma_1,
  \ldots, \sigma_n)$, где $\sigma_t: S \times I^{t-1} \rightarrow \Delta(I)$.
  Множество стратегий игрока 1 обозначим $\FPStrategies$.
\end{definition}

\begin{definition}
  Стратегией игрока 2 является последовательность ходов $\tauv = (\tau_1,
  \ldots, \tau_n)$, где $\tau_t: I^{t-1} \rightarrow \Delta(J)$. Множество
  стратегий игрока 2 обозначим $\SPStrategies$.
\end{definition}

Таким образом, игрок 1 на каждом шаге игры рандомизирует свои действия в
зависимости от состояния рынка $s$ и истории ставок. Игрок 2, в свою очередь, не
имея информации о состоянии рынка $s$, опирается только на историю ставок
инсайдера.

Будем считать, что игроки обладают неограниченными запасами рисковых и безрисковых активов, т.е. торги не могут прекратиться по причине того, что у одного из игроков закончатся деньги или акции.
Кроме того, будем считать, что в начальный момент времени оба игрока имеют нулевые портфели.

При использовании игроками стратегий $\sigmav$ и $\tauv$, ожидаемый выигрыш
игрока 1 равен
\begin{equation*}
  \K(\p, \sigmav, \tauv) =
  \E_{(\p, \sigmav, \tauv)} \sum_{t=1}^n \as(i_t, j_t),
\end{equation*}
где математическое ожидание берется по мере, индуцированной $\p$, $\sigmav$ и
$\tauv$. Заданную таким образом игру обозначим $\G(\p)$.

\begin{definition}
  Если для некоторых $\sigmav^* \in \FPStrategies,$ $\tauv^* \in \SPStrategies$
  выполняется
  \begin{equation*}
    \inf_{\tauv \in \SPStrategies} \K(\p, \sigmav^*, \tauv) =
    \K(\p, \sigmav^*, \tauv^*) =
    \sup_{\sigmav \in \FPStrategies} \K(\p, \sigmav, \tauv^*) = 
    \V(\p),
  \end{equation*}
  то игра $\G(\p)$ имеет значение $\V(\p)$, а стратегии $\sigmav^*$ и $\tauv^*$
  называются оптимальными.
\end{definition}

Следуя \cite{bib:domansky11}, опишем рекурсивную структуру игры $\G(\p)$.
Представим стратегию игрока 1 в виде $\sigmav = (\sigma, \sigmav^i, i \in I)$,
где $\sigma$~--- ход игрока на первом шаге, а $\sigmav^i$ --- стратегия в игре
продолжительности $n-1$ в зависимости от ставки $i$ на первом шаге. Аналогично,
стратегию игрока 2 представим в виде $\tauv = (\tau, \tauv^i, \; i \in I)$.
%
Далее, обозначим $q^i$ полную вероятность, с которой игрок 1 делает ставку $i
\in I$, и $\q = (q^i, \; i \in I)$ --- соответствующее распределение. Также
обозначим $p^{s|i}$ апостериорную вероятность состояния $s$ в зависимости от
ставки $i$ игрока 1, и $\p^i = (p^{s|i}, \, s \in S)$ --- соответствующее
апостериорное распределение. Тогда для функции выигрыша в игре $\G[n](\p)$ будет
справедлива формула
\begin{equation}
  \label{problem:eq:Kn-recurrence}
  \K[n](\p, \sigmav, \tauv) =
  \K[1](\p, \sigma, \tau) +
  \sum_{i \in I} q^i \K[n-1](\p^i, \sigmav^i, \tauv^i).
\end{equation}

\section{Оценка сверху выигрыша в игре $\mathbf{\G[\infty](\p)}$}
Следуя \cite{bib:domansky11}, рассмотрим следующую чистую стратегию неосведомленного игрока $\tauv^k = (\tau^k_t,\ t = \overline{1, \infty})$:
\begin{equation*}
  \tau^k_1 = k, \quad
  \tau^k_t(i_{t-1}, j_{t-1}) = \begin{cases}
    j_{t-1} - 1, &\; i_{t-1} < j_{t-1},\\
    j_{t-1}, &\; i_{t-1} = j_{t-1},\\
    j_{t-1}+1, &\; i_{t-1} > j_{t-1}.
  \end{cases}
\end{equation*}
При использовании этой стратегии игрок~2 делает ставку равную $k$ на первом шаге, а далее подражает инсайдеру.
Введем обозначение $x^+ = \max(0, x), \, x \in \mathbb{R}$.

\begin{lemma}
  \label{upper-bound:lemma:vector-payoffs}
  При применении стратегии $\tauv^k$ в игре $\G(\p)$ игрок~2 в состоянии $s$ гарантирует себе проигрыш не более
  \begin{gather*}
    h^s_n(\tauv^k) = \sum_{t=0}^{n-1} (k-s-t-1+\beta)^+, \; s \leqslant k, \\
    h^s_n(\tauv^k) = \sum_{t=0}^{n-1} (s-k-t-\beta)^+, \; s > k.
  \end{gather*}
  Последовательность $\left\{ h^s_n(\tauv^k), \; n = \overline{1, \infty}
  \right\}$ не убывает, ограничена сверху и сходится к %
  \begin{equation}
    \label{upper-bound:eq:max-payoff}
    h^s_\infty(\tauv^k) = (s - k + 1 - 2\beta)(s-k)/2.
  \end{equation}
\end{lemma}

Введем следующие обозначения для множества распределений на $S$ с заданным
математическим ожиданием состояния:
\begin{gather*}
  \Theta(x) = \left\{ \p' \in \Delta(S): \E \p' = x \right\}, \\
  \Lambda(x, y) = \left\{ \p' \in \Delta(S): x < \E \p' \leqslant y \right\}.
\end{gather*}

Пусть $\tauv^*$ --- стратегия игрока 2, состоящая в применении $\tauv^k$ при $\p
\in \Lambda(k-1+\beta,k+\beta)$.

\begin{theorem}
  \label{upper-bound:theorem}
  При использовании игроком 2 стратегии $\tauv^*$, выигрыш игрока 1 в игре
  $\G[\infty](\p)$ ограничен сверху функцией
  \begin{equation*}
    \High(\p) = \min_{k \in J} \sum_{s \in S} p^s  h^s_\infty(\tauv^k).
  \end{equation*}
  Функция $\High(\p)$ является кусочно-линейной с областями линейности
  $\Lambda(k - 1 + \beta, k + \beta)$ и областями недифференцируемости
  $\Theta(k+\beta)$ при $k \in S$. Для распределений $\p$ таких, что $\E \p = k
  - 1 + \beta + \xi, \; \xi \in (0, 1]$, ее значение равно
  \begin{equation}
    \label{upper-bound:eq:H(p)}
    \High(\p) = \left( \D \p + \beta(1-\beta) - \xi(1-\xi) \right)/2.
  \end{equation}
\end{theorem}
Заметим, что как и в \cite{bib:pyanykh16}, в данном случае наблюдается сдвиг областей линейности на $\beta$ относительно $\E \p$ в сравнении с результатами из \cite{bib:domansky11}.
Кроме того, хотя описание чистой стратегии $\tauv^k$ неосведомленного игрока повторяет описание из \cite{bib:domansky07}, стратегия $\tauv^*$ игрока~2 зависит от $\beta$ в силу того, что от $\beta$ зависит выбор конкретной $\tauv^k$ в определении $\tauv^*$.

\section{Оценка снизу выигрыша в игре $\mathbf{\G[\infty](\p)}$}
\label{sec:lower-bound}

Перейдем к описанию стратегии игрока 1, которая гарантирует ему выигрыш не менее
$\High(\p)$. Пусть $\sigma^s_i$ --- компонента хода $\sigma$ игрока 1, т.е.
вероятность сделать ставку $i$ в состоянии $s$. По правилу Байеса $\sigma^s_i =
p^{s|i} q^i / p^s$. В частности, справедливо $\sum_{s \in S} \sigma^s_i p^s =
q^i,\ i \in I$. Таким образом, ход игрока 1 можно определить, задав следующие
параметры: полные вероятности $q^i$ сделать ставку $i$ и апостериорные
вероятности $p^{s|i}$ для $i \in I$. Тогда в терминах $\q$, $\p^i$ его
одношаговый выигрыш выражается следующим образом:
\begin{equation}
  \label{lower-bound:eq:K1(q,pi)}
  \K[1](\p, \sigma, j) = \sum_{i \in I} \sum_{s \in S} q^i p^{s|i} \as(i, j).
\end{equation}

Обозначим через $\Low[n](\p)$ --- максимальный выигрыш, который может
гарантировать себе игрок 1 в игре $\G(\p)$.
\begin{lemma}
  \label{lower-bound:lemma:convex-combination}
  Пусть $\p_k$ --- распределение из $\Delta(S)$, $\sigmav_k$ --- стратегия
  игрока 1, которая гарантирует ему выигрыш $\Low[n](\p_k)$ в игре $\G[n](\p_k)$,
  и $\q_k = (q^1_k, \ldots, q^n_k),\ \p^i_k = ( p^{1|i}_k, p^{2|i}_k, \ldots)$
  --- векторы полных вероятностей ставок и апостериорных вероятностей состояния,
  соответствующие первому ходу стратегии $\sigmav_k,\ k = 1,2$. Тогда для $\p =
  \lambda \p_1 + (1-\lambda) \p_2, \; \lambda \in [0, 1],$ стратегия
  $\sigmav_c$, первый ход которой задается параметрами
  \begin{equation}
    \label{lower-bound:eq:q-pi}
    q^i = \lambda q^i_1 + (1-\lambda) q^i_2, \quad
    p^{s|i} = \left(\lambda q^i_1 p^{s|i}_1 + (1-\lambda) q^i_2 p^{s|i}_2\right)/q^i,
  \end{equation}
  гарантирует игроку 1 выигрыш $\lambda \Low[n](\p_1) + (1-\lambda)
  \Low[n](\p_2)$.
\end{lemma}


Из теоремы~\ref{upper-bound:theorem} и леммы~\ref{lower-bound:lemma:convex-combination} следует, что для доказательства совпадения верхней и нижней оценок выигрыша в игре $\G[\infty](\p)$ можно ограничиться рассмотрением только распределений $\p~\in~\Theta(k + \beta), \; k \in S$.
Как показано в \cite{bib:domansky11}, любое $\p$ может быть представлено в виде выпуклой комбинации распределений с двухточечным носителем.
Обозначим $\p^x(l, r) \in \Theta(x)$ распределение с математическим ожиданием $x$ и носителем $\{l, r\}$.
Таким образом, достаточно доказать выполнение равенства $\Low(\p)~=~\High(\p)$ для распределения $\p = \p^{k+\beta}(l,r), \; k \in S$.
Построим соответствующую стратегию игрока~1.

Обозначим $\sigmak_k$ ход игрока 1, состоящий в применении действий $k$ и $k+1$.
Ход $\sigmak_k$ определяется заданием полных вероятностей $q^k, q^{k+1}$ и
апостериорных распределений $\p^k, \p^{k+1}$, причем $q^k + q^{k+1} = 1$.
Следующая лемма является обобщением утверждения 2 из \cite{bib:pyanykh16}.
\begin{lemma}
  \label{lower-bound:lemma:stage-payoff}
  При использовании $\sigmak_k$ одношаговый выигрыш игрока 1 равен
  \begin{equation*}
    \small
    \K[1](\p, \sigmak_k, j) = \begin{cases}
      \E \p - \beta k - (1-\beta) j - \beta q^{k+1}, &\; j < k, \\
      (\E \p^{k+1} - k - \beta) q^{k+1}, &\; j = k, \\
      (k + \beta - \E \p^k) q^k, &\; j = k+1, \\
      (1-\beta) k + \beta j - \E \p + (1-\beta) q^{k+1}, &\; j > k + 1.
    \end{cases}
  \end{equation*}
\end{lemma}

Распространяя результаты \cite{bib:pyanykh16} на случай $\p^{k+\beta}(l, r)$, определим следующую стратегию игрока 1 в игре $\G[\infty](\p)$.
Введем обозначение %
\begin{equation*}
  P(l,r) = \left\{
    \p^k(l, r), \, \p^{s+\beta}(l, r), \, k = \overline{l,r}, s = \overline{l,r-1}
  \right\}.
\end{equation*}
При $\p \in P(l,r)$ первый ход стратегии $\sigmav^*$ определяется следующим
образом: если $\p = \p^l(l,r)$ или $\p = \p^r(l,r)$ игрок 1 использует ставки
$l$ и $r$, соответственно, с вероятностью 1; иначе игрок 1 использует
$\sigmak_k$ с параметрами
\begin{equation}
  \label{eq:insider-strategy}
  \begin{aligned}
    &\p^k(l, r):&
    &q^k = \beta,&
    &q^{k+1} = 1-\beta,\\
    && 
    &\p^k = \p^{k-1+\beta}(l, r),&
    &\p^{k+1} = \p^{k+\beta}(l, r);\\
    &\p^{k+\beta}(l, r):&
    &q^k = 1-\beta,&
    &q^{k+1} = \beta,\\
    &&
    &\p^k = \p^k(l, r),&
    &\p^{k+1} = \p^{k+1}(l, r).&
  \end{aligned}
\end{equation}

На последующих шагах игры таким образом определенный ход применяется рекурсивно
для соответствующих значений апостериорных вероятностей. Для остальных
распределений $\p$ стратегия $\sigmav^*$ определяется конструкцией
леммы~\ref{lower-bound:lemma:convex-combination}.


Обозначим $L^x_{l,r} = \Low(\p^x(l,r))$. Следующая теорема является обобщением
утверждения 5 из \cite{bib:pyanykh16}.
\begin{theorem}
  \label{lower-bound:theorem}
  При использовании стратегии $\sigmav^*$ в игре $\G[\infty](\p)$ для
  распределения %
  $\p \in P(l,r)$ %
  гарантированный выигрыш игрока~1 удовлетворяет следующей системе:
  \begin{equation}
    \label{lower-bound:eq:Linf-recurrence}
    \begin{gathered}
      L^{k+\beta}_{l,r} =
      \beta(1-\beta) + (1-\beta) L^k_{l,r} + \beta L^{k+1}_{l,r}, \;
      k \in \overline{l, r - 1}, \\
      L^k_{l,r} =
      \beta L^{k-1+\beta}_{l,r} + (1-\beta) L^{k+\beta}_{l,r}, \;
      k \in \overline{l + 1, r - 1},\\
      L^l_{l,r} = L^r_{l,r} = 0.
    \end{gathered}
  \end{equation}
  Ее решение дает нижнюю оценку выигрыша игрока 1 равную
  \begin{equation*}
    \label{lower-bound:eq:Linf-recurrence-solution}
    \Low(\p^{k+\beta}(l, r)) = ((r-k-\beta)(k+\beta-l) + \beta(1-\beta))/2.
  \end{equation*}
\end{theorem}

В силу справедливости равенства
\[
  \D p^{k+\beta}(l, r) = (r-k-\beta)(k+\beta-l)
\]
получаем, что выражения для $\High(\p^{k+\beta}(l,r))$ и $\Low(\p^{k+\beta}(l,r))$ совпадают.

\section{Решение игры $\mathbf{\G[\infty](p)}$}
\label{sec:game-solution}

Отметим, что приведенная в п.~\ref{sec:lower-bound} стратегия инсайдера $\sigma^*$ определена только при $\beta \in (0, 1)$.

Нетрудно проверить справедливость следующего равенства:
\begin{equation}
  \label{eq:as-symmetric}
  a^{r, \beta}(i, j) = a^{l, 1-\beta}(r+l-i, r+l-j).
\end{equation}
Из (\ref{eq:as-symmetric}) видно, что решение игры $\G[\infty](\p^x(l, r))$ сводится к решению игры $G^{1-\beta}_\infty(\p^{l+r-x}(l,r))$.
При этом ставки, используемые в соответствующих смешанных стратегиях инсайдера, симметричны относительно $(l+r)/2$.
Аналогичные рассуждения справедливы для $\G[\infty](\p)$ при любом $\p$.

Оптимальная стратегия $\sigmav^*$ инсайдера в игре $\G[\infty](\p)$ при $\beta = 1$ приведена в~\cite{bib:domansky11}.
Решение $\G[\infty](\p)$ при $\beta = 0$ может быть получено при помощи описанной выше конструкции.
Таким образом, при любом $\beta \in [0, 1]$ справедлива следующая
\begin{theorem}
  \label{solution:theorem}
  Игра $\G[\infty](\p)$ имеет значение
  \[
    \V[\infty](\p) = \High(\p) = \Low(\p).
  \]
  Стратегии $\tauv^*$ и $\sigmav^*$, определенные ранее, являются оптимальными.
\end{theorem}

\begin{figure}[tbh]
  \small
  \centering
  \begin{tikzpicture}
    [
    auto,node distance=1.25cm,
    trans/.style={->,shorten >=1pt,>=stealth',semithick},
    state/.style={shape=circle,draw,minimum size=2mm}
    ]
    \node[state,label={$p^l(l,r)$}] (p0) {};
    \node[state,right=of p0,label={$p^{l+\beta}(l,r)$}] (p1) {}; 
    \node[state,right=of p1,label={$p^{l+1}(l,r)$}] (p2) {};
    \node[right=of p2] (others) {$\ldots$};
    \node[state,right=of others,label={$p^{r-1+\beta}(l,r)$}] (p2mm1) {};
    \node[state,right=of p2mm1,label={$p^r(l,r)$}] (p2m) {};
    
    \path [trans]
    (p0) edge [loop left,min distance=10mm,out=205,in=155] node {$1$} (p0)
    (p1) edge[bend right] node[below] {$1-\beta$} (p0)
    (p1) edge[bend left] node[below] {$\beta$} (p2)
    (p2) edge[bend left] node[below] {$\beta$} (p1)
    (p2) edge[bend right] node[below] {$1-\beta$} (others)
    (p2mm1) edge[bend left] node[below] {$1-\beta$} (others)
    (p2mm1) edge[bend right] node[below] {$\beta$} (p2m)
    (p2m) edge[loop right,min distance=10mm,out=25,in=-25] node {$1$} (p2m)
    ;
  \end{tikzpicture}
  \caption[Последовательность апостериорных вероятностей]{Случайное блуждание последовательности апостериорных вероятностей, порожденное $\sigmav^*$}
  \label{fig:posterior-1}
\end{figure}

Использование игроком~1 стратегии $\sigmav^*$ порождает случайное блуждание последовательности апостериорных вероятностей, изображенное на рисунке~\ref{fig:posterior-1}, которое в отличие от \cite{bib:domansky11} происходит по более широкому множеству и уже не является симметричным, кроме случая $\beta = 1/2$.

В дополнение к стратегии, определенной выражением (\ref{eq:insider-strategy}), приведем еще одну оптимальную стратегию инсайдера.
Введем обозначение %
\begin{equation*}
  P'(l,r) =
  \{\p^l(l, r), \p^r(l, r)\}
  \cup
  \left\{
    \p^{k+\beta}(l, r), \, k = \overline{l, r-1}
  \right\}.
\end{equation*}
При $\p \in P'(l,r)$ первый ход стратегии $\xiv^*$ определяется следующим образом: если $\p = \p^l(l,r)$ или $\p = \p^r(l,r)$ игрок 1 использует ставки $l$ и $r$, соответственно, с вероятностью 1; иначе игрок 1 использует $\sigmak_k$ с параметрами
\begin{equation}
  \label{eq:insider-strategy2}
  \begin{aligned}
    &\p^{l+\beta}(l, r):&
    &q^l = \frac{1}{1+\beta},&
    &q^{l+1} = \frac{\beta}{1+\beta},\\
    && 
    &\p^l = \p^l(l, r),&
    &\p^{l+1} = \p^{l+1+\beta}(l, r);\\
    %
    &\p^{r-1+\beta}(l, r):&
    &q^{r-1} = \frac{1-\beta}{2-\beta},&
    &q^r = \frac{1}{2-\beta},\\
    && 
    &\p^{r-1} = \p^{r-1}(l, r),&
    &\p^r = \p^r(l, r);\\
    %
    &\p^{k+\beta}(l, r):&
    &q^k = \frac{1}{2},&
    &q^{k+1} = \frac{1}{2},\\
    &&
    &\p^k = \p^{k-1+\beta}(l, r),&
    &\p^{k+1} = \p^{k+1+\beta}(l, r).&
  \end{aligned}
\end{equation}
Для остальных распределений $\p$ стратегия $\xiv^*$ так же определяется конструкцией леммы~\ref{lower-bound:lemma:convex-combination}.

Использование стратегии $\xiv^*$ порождает случайное блуждание последовательности апостериорных вероятностей, изображенное на рисунке~\ref{fig:posterior-2}.
Данное случайное блуждание симметрично с вероятностями перехода в соседние состояния равными $1/2$, симметрия нарушается только на краях.

\begin{figure}[tbh]
  \small
  \centering
  \begin{tikzpicture}
    [
    auto,yscale=1.3,node distance=1.25cm,
    trans/.style={->,shorten >=1pt,>=stealth',semithick},
    state/.style={shape=circle,draw,minimum size=2mm}
    ]
    \node[state,label={$p^l(l,r)$}] (p0) {};
    \node[state,right=of p0,label={$p^{l+\beta}(l,r)$}] (p1) {}; 
    \node[state,right=of p1,label={$p^{l+1+\beta}(l,r)$}] (p2) {};
    \node[right=of p2] (others) {$\ldots$};
    \node[state,right=of others,label={$p^{r-1+\beta}(l,r)$}] (p2mm1) {};
    \node[state,right=of p2mm1,label={$p^r(l,r)$}] (p2m) {};
    
    \path [trans]
    (p0) edge [loop left,min distance=10mm,out=205,in=155] node {$1$} (p0)
    (p1) edge[bend right] node[below] {$\frac{1}{1+\beta}$} (p0)
    (p1) edge[bend left] node[below] {$\frac{\beta}{1+\beta}$} (p2)
    (p2) edge[bend left] node[below] {$\frac{1}{2}$} (p1)
    (p2) edge[bend right] node[below] {$\frac{1}{2}$} (others)
    (p2mm1) edge[bend left] node[below] {$\frac{1-\beta}{2-\beta}$} (others)
    (p2mm1) edge[bend right] node[below] {$\frac{1}{2-\beta}$} (p2m)
    (p2m) edge[loop right,min distance=10mm,out=25,in=-25] node {$1$} (p2m)
    ;
  \end{tikzpicture}
  \caption[Последовательность апостериорных вероятностей]{Случайное блуждание последовательности апостериорных вероятностей, порожденное $\xiv^*$}
  \label{fig:posterior-2}
\end{figure}

При использовании стратегии $\xiv^*$ в игре $\G[\infty](\p)$ для распределения %
$\p \in P(l,r)$ %
гарантированный выигрыш игрока~1 удовлетворяет следующей системе:

\begin{equation}
  \label{lower-bound:eq:Linf-recurrence-2}
  \begin{gathered}
    L^{k+\beta}_{l,r} =
    \frac{1}{2} + \frac{1}{2} L^k_{l,r} + \frac{1}{2} L^{k+1}_{l,r}, \;
    k \in \overline{l+1, r-2}, \\
    L^{l+\beta}_{l,r} =
    \frac{\beta}{1+\beta} + \frac{1}{1+\beta} L^l_{l,r} + \frac{\beta}{1+\beta} L^{l+1+\beta}_{l,r},\\
    L^{r-1+\beta}_{l,r} =
    \frac{1-\beta}{2-\beta} + \frac{1-\beta}{2-\beta} L^{r-2+\beta}_{l,r} + \frac{1}{2-\beta} L^r_{l,r},\\
    L^l_{l,r} = L^r_{l,r} = 0.
  \end{gathered}
\end{equation}

Нетрудно проверить, что подстановкой $\High(\p^{k+\beta}(l,r))$ вместо $L^{k+\beta}_{l,r}$ данные равенства обращаются в тождества.
Отсюда стратегия $\xiv^*$ является оптимальной.

Отметим, что в отличие от стратегии $\sigmav^*$ стратегия $\xiv^*$ определена при $\beta \in [0, 1]$ и совпадает с оптимальной стратегией инсайдера из \cite{bib:domansky11} при $\beta = 1$.
При этом стратегии $\sigmav^*$ и $\xiv^*$ порождают существенно отличные случайные блуждания апостериорных вероятностей.

% В то же время оптимальная стратегия инсайдера существенно зависит от $\beta$.
% В \cite{bib:domansky11} при применении оптимальной стратегии игроком 1, апостериорные распределения образуют симметричное случайное блуждание по множествам $\Theta(s), \, s \in S$, т.е. для $\p \in \Theta(s)$ апостериорное распределение $\p'$ будет принадлежать либо $\Theta(s-1)$, либо $\Theta(s+1)$ с вероятностями равными $1/2$.
% В случае $\beta \in (0, 1)$ блуждание происходит по более широкому набору множеств %
% $\left\{ \Theta(s), \Theta(s+\beta) \right \}$, %
% кроме того оно больше не является симметричным, кроме случая $\beta = 1/2$.
% Отметим также, что оптимальная стратегия $\sigmav^*$ не сводится к стратегии из \cite{bib:domansky11} при $\beta \rightarrow 1$.

\appendix

\begin{proof}\underline{[Лемма~\ref{upper-bound:lemma:vector-payoffs}]}
  Проведем доказательство по индукции для случая $s > k$. При $n = 1$
  оптимальный ответ игрока 1 на $\tauv^k$ будет $i = k + 1$. Тогда его выигрыш в
  игре $\G[1](\p)$ равен
  \begin{equation*}
    h^s_1(\tauv^k) = s - \beta(k+1) - (1-\beta)k = s - k - \beta.
  \end{equation*}
  База индукции проверена. Предположим, что утверждение верно при $n \leqslant
  N$. При $n = N + 1$ игрок 1 имеет два разумных ответа на $\tauv^k$: ставка $i
  = k + 1$, что соответствует покупке акции по наименьшей возможной цене, и
  ставка $i = k - 1$, что соответствует продаже акции за наибольшую возможную
  цену. Найдем оценки выигрыша в каждом из случаев. Для $i = k + 1$ выигрыш
  игрока 1 не превосходит величины
  \begin{equation*}
    s - k - \beta + h^s_N(\tauv^{k+1}) = \sum_{t=0}^N(s-k-t-\beta)^+.
  \end{equation*}
  Аналогично для $i = k - 1$ тот же выигрыш не превосходит
  \begin{equation*}
    \beta k + (1-\beta)(k-1) - s + h^s_N(\tauv^{k-1}) = \sum_{t=0}^{N-2}(s-k-t-\beta)^+.
  \end{equation*}
  При $s \leqslant k$ формула для $h^s_n(\tauv^k)$ доказывается аналогично.
  Сходимость $h^s_n(\tauv^k)$ к $h^s_\infty(\tauv^k)$ следует из равенства
  $h^s_n(\tauv^k) = h^s_{n+1}(\tauv^k)$ при $n \geqslant s - k$.
\end{proof}

\begin{proof}\underline{[Теорема~\ref{upper-bound:theorem}]}
  Воспользовавшись \eqref{upper-bound:eq:max-payoff}, получим
  \begin{equation}
    \label{upper-bound:theorem:eq:1}
    \begin{gathered}
    \sum_{s \in S} p^s h^s_\infty(\tauv^j) = \bigl(
      j^2 + (2\beta - 1 - 2 \E \p)j - \\
      - (2\beta - 1) \E \p + \E \p^2 
    \bigr)/2.
    \end{gathered}
  \end{equation}
  
  Квадратичная функция $f(x) = x^2 + (2\beta - 1 - 2\E \p)x$ достигает минимума
  при $x = \E \p - \beta + 1/2$. Отсюда при $\p \in \Lambda(k - 1 + \beta, k +
  \beta)$ выражение \eqref{upper-bound:theorem:eq:1} достигает минимума при $j =
  k$. Равенство \eqref{upper-bound:eq:H(p)} проверяется непосредственной
  подстановкой $\E \p = k - 1 + \beta + \xi$ в \eqref{upper-bound:theorem:eq:1}.
\end{proof}

\begin{proof}\underline{[Лемма~\ref{lower-bound:lemma:convex-combination}]}
  Проведем доказательство по индукции. Покажем, что справедливо равенство %
  \begin{equation}
    \label{lower-bound:lemma:convex-combination:eq:1}
    \K[n](\p, \sigmav_c, \tauv) =
    \lambda \K[n](\p_1, \sigmav_1, \tauv) +
    (1-\lambda)\K[n](\p_1, \sigmav_2, \tauv).
  \end{equation}
  Подставив \eqref{lower-bound:eq:q-pi} в
  \eqref{lower-bound:eq:K1(q,pi)}, получим
  \begin{gather*}
    \K[1](\p, \sigmav_c, j) = \sum_{i \in I, \, s \in S}
    q^i \frac{\lambda q^i_1 p^{s|i}_1 + (1-\lambda) q^i_2 p^{s|i}_2}{q^i} \as(i,j) = \\
    = \lambda \sum_{i \in I, \, s \in S} q^i_1 p^{s|i}_1 \as(i,j) +
    (1-\lambda) \sum_{i \in I, s \in S} q^i_2 p^{s|i}_2 \as(i, j) = \\
    = \lambda \K[1](\p_1, \sigmav_1, j) +
    (1-\lambda)\K(\p_2, \sigmav_2, j).
  \end{gather*}
  Таким образом, утверждение справедливо при $n = 1$. Пусть утверждение имеет
  место при $n \leqslant N$. Тогда из \eqref{problem:eq:Kn-recurrence} вытекает
  \begin{gather*}
    \K[N+1](\p, \sigmav_c, \tauv) =
    \K[1](\p, \sigmav_c, \tauv) +
    \sum_{i \in I} q_i \K[N](\p^i, \sigmav^i_c, \tau^i) = \\
    = \lambda \K[1](\p_1, \sigma_1, \tau) +
    (1-\lambda) \K[1](\p_2, \sigma_2, \tau) + \\
    + \sum_{i \in I} q^i \left(
      \frac{\lambda q^i_1}{q^i} \K[N](\p^i_1, \sigmav^i_1, \tauv^i) +
      \frac{(1-\lambda) q^i_2}{q^i} \K[N](\p^i_2, \sigmav^i_2, \tauv^i)
    \right) = \\
    = \lambda \K[N+1](\p_1, \sigmav_1, \tauv) +
    (1-\lambda)\K[N+1](\p_1, \sigmav_2, \tauv).
  \end{gather*}
  Справедливость равенства \eqref{lower-bound:lemma:convex-combination:eq:1}
  доказана. Отсюда получаем
  \begin{multline*}
    \Low[n](\p) = \min_{\tauv \in \SPStrategies} \K[n](\p, \sigmav_c, j) \geqslant
    \lambda \min_{\tauv \in \SPStrategies} \K[n](\p, \sigmav_1, j) + \\
    + (1-\lambda) \min_{\tauv \in \SPStrategies} \K[n](\p, \sigmav_2, j) =
    \lambda \Low[n](\p_1) + (1-\lambda) \Low[n](\p_2).
  \end{multline*}
  Получили, что стратегия $\sigmav_c$ обеспечивает игроку 1 в игре $\G[n](\p)$
  соответствующую выпуклую комбинацию гарантированных выигрышей в играх
  $\G[n](\p_1)$ и $\G[n](\p_2)$.
\end{proof}

\begin{proof}\underline{[Лемма~\ref{lower-bound:lemma:stage-payoff}]}
  По аналогии с \cite{bib:pyanykh16} можно показать, что
  \begin{equation*}
    \as(\sigmak_k, j) = \begin{cases}
      s - \beta k - (1-\beta) j - \beta \sigma^s_{k+1}, &\; j < k,\\
      (s - k - \beta) \sigma^s_{k+1}, &\; j = k,\\
      (k + \beta - s) \sigma^s_k, &\; j = k+1,\\
      (1-\beta) k + \beta j - s + (1-\beta) \sigma^s_{k+1}, &\; j > k + 1.
    \end{cases}
  \end{equation*}
  Отсюда непосредственно следует утверждение леммы.
\end{proof}

\begin{proof}\underline{[Теорема~\ref{lower-bound:theorem}]}
  Для $\p \in P(l,r)$ определение стратегия $\sigmav^*$ аналогично определению
  оптимальной стратегии игрока 1 из \cite{bib:pyanykh16} с заменой $0, m$ на $l,
  r$ соответственно.

  Параметры $\q$ и $\p^i$ подобраны таким образом, чтобы выполнялись равенства %
  \[
    \Low[1](\p^k(l,r)) = 0, \, \Low[1](\p^{k+\beta}(l,r)) = \beta(1-\beta),
  \]
  а апостериорные распределения принадлежали тому же множеству $P(l,r)$.
  Полученная система \eqref{lower-bound:eq:Linf-recurrence} является системой с
  трехдиагональной матрицей и решается методом прогонки аналогично тому, как это
  было сделано в \cite{bib:pyanykh16}.
\end{proof}

\begin{thebibliography}{10}
\bibitem{bib:domansky11}%
  {\MakeUppercase{Доманский В.К., Крепс В.Л.}} \textit{Теоретико-игровая модель биржевых торгов: стратегические аспекты формирования цен на фондовых рынках} // Журнал Новой экономической ассоциации. -- 2011. -- Вып. 11. -- C. 39--62.

\bibitem{bib:kreps09}%
  {\MakeUppercase{Крепс В.Л.}} \textit{Повторяющиеся игры, моделирующие биржевые
    торги, и возвратные последовательности} // Известия РАН. Теория и системы управления. -- 2009. -- № 4. -- С. 109--120.

\bibitem{bib:pyanykh14}%
  {\MakeUppercase{Пьяных А.И.}} \textit{Об одной модификации модели биржевых торгов с инсайдером} // Математическая теория игр и ее приложения. -- 2014. -- Т. 6, №4. - С. 68--84.

\bibitem{bib:pyanykh16}%
  {\MakeUppercase{Пьяных А.И.}} \textit{Многошаговая модель биржевых торгов с
    асимметричной информацией и элементами переговоров} // %
  Вестн. Моск. ун-та. Сер.15. Вычисл. матем. и киберн. -- 2016. -- №1. -- С.
  34—-40.

\bibitem{bib:sandomirskaya12}%
  {\MakeUppercase{Сандомирская М.С., Доманский В.К.}} \textit{Решение
    одношаговой игры биржевых торгов с неполной информацией} // %
  Математическая теория игр и ее приложения. -- 2012. -- Т. 4, №1. -- С. 32--54.

\bibitem{bib:aumann}%
  {\MakeUppercase{Aumann R.J., Maschler M.B.}} \textit{Repeated Games with
    Incomplete Information}. %
  Cambridge, Mass.: The MIT Press, 1995.

\bibitem{bib:chatterjee83}%
  {\MakeUppercase{Chatterjee K., Samuelson W.}} \textit{Bargaining under
    Incomplete Information} // %
  Operations Research. -- 1983. -- Vol. 31, № 5. -- P. 835--851.

\bibitem{bib:demeyer02}%
  {\MakeUppercase{De Meyer B.}} \textit{On the strategic origin of Brownian motion in finance} // International Journal of Game Theory. -- 2002. -- Vol. 31, №2. -- P. 285--319. 

\bibitem{bib:domansky07}%
  {\MakeUppercase{Domansky V.}} \textit{Repeated games with asymmetric
    information and random price fluctuations at finance markets} // %
  International Journal of Game Theory. -- 2007. -- Vol. 36, № 2. -- P. 241--257.

\bibitem{bib:mertens15}
  {\MakeUppercase{Mertens J.--F., Sorin S., Zamir S.}} \textit{Repeated games}. Cambridge: Cambridge University Press, 2015.
\end{thebibliography}

\makeenginfo
\makeauxinfo
\end{document}
