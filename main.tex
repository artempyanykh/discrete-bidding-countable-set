%% -*- coding: cp1251; -*-
\documentclass[11pt, draft]{ubs}

\usepackage{graphicx}

\issue{XX}% Выпуск Сборника - проставляется в процессе верстки
\rubric{Системный анализ}% Рубрика Сборника - может быть скорректирована редактором
%
% Имеющиеся рубрики (последнюю информацию см. на сайте ubs.mtas.ru):
%
%    Системный анализ
%    Математическая теория управления
%    Анализ и синтез систем управления
%    Информационные технологии в управлении
%    Управление в социально-экономических системах
%    Управление в медико-биологических и экологических системах
%    Управление техническими системами и технологическими процессами
%    Управление подвижными объектами и навигация
%    Технические и программные средства управления
%    Надежность и диагностика средств и систем управления
%    Программы и системы моделирования объектов, средств и систем управления

%    В соответствии с требованиями ВАК коды УДК и ББК обязательны. Проставляются
%    автором. Могут быть скорректированы редактором
\udk{УДК 519.83}
\bbk{ББК 22.18}

\title{Многошаговая модифицированная модель биржевой игры со счетным множеством состояний}

\engtitle{Multistage modified bidding model with a countable set of states}

\thanks{\footnote{%
    Исследование выполнено при финансовой поддержке РФФИ в рамках научного
    проекта №16-01-00353a. %
    Автор признателен своему научному руководителю к.ф.-м.н., доценту
    В.В.~Морозову за помощь в написании данной статьи.%
}}

\authors{%
  \textbf{Пьяных~А.И.}\footnote{Артем Игоревич Пьяных, аспирант
    (artem.pyanykh@gmail.com).}\\
  \textit{(Московский государственный университет имени М.В.~Ломоновосова,
    Москва)}%
}
%
\engauthors{%
  \textbf{Artem Pyanykh}, Lomonosov Moscow State University, Moscow,
  post-graduate student (artem.pyanykh@gmail.ru).%
}

\abstract{
  Рассматривается упрощенная модель финансового рынка, на котором два игрока ведут торговлю однотипными акциями в течение некоторой последовательности шагов.
  Первый игрок (инсайдер) информирован о настоящей ликвидной цене акции, которая может принимать любое значение из $\Z_+$.
  В то же время второй игрок знает только вероятностное распределение $\p$ цены акции и что первый игрок --- инсайдер.
  На каждом шаге торгов игроки делают целочисленные ставки.
  Игрок, предложивший б\'{о}льшую ставку, покупает у другого акцию по цене, равной выпуклой комбинации предложенных ставок с некоторым коэффициентом $\beta$.
  После каждого хода сделанные ставки становятся известнымы обоим игрокам.
  В работе получено решение повторяющейся антигонистической игры неограниченной продолжительности, отвечающей данной модели, для распределений $\p$ с конечной дисперсией.
}
\engabstract{%
  A simplified financial market model with two players bidding for one unit of a risky asset for several consequtive stages is considered.
  First Player (an insider) is informed about the liquidation price of the asset which can take any value in $\Z_+$.
  At the same time Second Player knows only probability distribution $\p$ of the price and that First Player is an insider.
  At each bidding stage players place integer bids.
  The higher bid wins and one unit of the asset is transacted to the winning player at the cost equal to a convex combination of the bids with some coefficient $\beta$.
  After each stage the bids are announced to the players.
  In this paper we obtain a solution to an infinitely long zero-sum game corresponding to the described model for distributions $\p$ with finite variation.%
}

\keywords{многошаговые антагонистические игры, асимметричная информация, инсайдерская торговля}
\engkeywords{repeated zero-sum games, asymmetric information, insider trading}

\presented{...}% Член редколлегии, представляющий статью к публикации,
               % заполняется редактором, например, Ивановым А.А.
\received{...}% Дата получения материала редакционной коллегией - может
              % корректироваться редактором
\published{...}% Дата опубликования статьи, заполняется редактором

\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows}
\usetikzlibrary{automata}

\usepackage{xcolor}
\newcommand{\todo}[1]{\textcolor{red}{#1}}

\newcommand{\overbar}[1]%
{\mkern 1.5mu\overline{\mkern-1.3mu#1\mkern-1.3mu}\mkern 1.3mu}

\newcommand{\as}[1][\beta]{\ensuremath{a^{s,#1}}}
\newcommand{\s}{\ensuremath{s}}
\newcommand{\p}{\ensuremath{\overbar{p}}}
\newcommand{\q}{\ensuremath{\overbar{q}}}
\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\D}{\mathbb{D}}
\DeclareMathOperator{\Z}{\mathbb{Z}}
\newcommand{\G}[1][n]{\ensuremath{G^\beta_{#1}}}
\newcommand{\K}[1][n]{\ensuremath{K^\beta_{#1}}}
\DeclareMathOperator{\Tau}{\mathrm{T}}
\newcommand{\V}[1][n]{\ensuremath{V^\beta_{#1}}}
\newcommand{\High}[1][\ensuremath{\infty}]{\ensuremath{H^\beta_{#1}}}
\newcommand{\sigmav}{\ensuremath{\overbar{\sigma}}}
\newcommand{\tauv}{\ensuremath{\overbar{\tau}}}
\newcommand{\xiv}{\ensuremath{\overbar{\xi}}}
\newcommand{\sigmak}{\ensuremath{\hat{\sigma}}}
\newcommand{\Low}[1][\ensuremath{\infty}]{\ensuremath{L^\beta_{#1}}}
\newcommand{\eqdef}{\overset{\mathrm{def}}{=}}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\LL}{L^1(\{s^2\})}

\begin{document}

\maketitle

\section*{Введение}
\label{sec:intro}

В данной работе рассматривается упрощенная модель финансового рынка, изученная, в частности, в работах \cite{bib:domansky07, bib:domansky11}, на котором два игрока ведут торговлю однотипными акциями на протяжении $n \leqslant \infty$ шагов.
Перед началом торгов случайный ход определяет цену акции $\s \in S$ на весь период торгов в соответствии с вероятностным распределением $\p = (p^s, \; s \in S)$.
Выбранная цена сообщается первому игроку (инсайдеру).
Второй игрок при этом знает только вероятностное распределение $\p$ и не осведомлен о настоящем значении цены.
Также второй игрок знает, что первый игрок --- инсайдер.
На каждом шаге торгов игроки одновременно и независимо назначают некоторую цену за акцию.
Игрок, сделавший б\'{о}льшую ставку, покупает акцию у другого; если ставки равны, сделки не происходит.
После каждого шага торгов выбранные ставки сообщаются игрокам.
Задачей каждого игрока является максимизация стоимости итогового портфеля, состоящего из некоторого числа купленных акций и суммы денег, полученных в результате торгов.
Данное описание считается известным обоим игрокам.

Впервые подобная задача была рассмотрена Б.~Де~Мейером и Х.~Салей в \cite{bib:demeyer02}.
В их модели цена акции может принимать два значения $0$ и $1$, а игроки могут делать произвольные вещественные ставки из отрезка $[0, 1]$.
Данную модель мы будем называть непрерывной.
В рамках такой модели торгов на финансовом рынке авторами была продемонстрирована возможность стратегического происхождения броуновского движения в эволюции цен на финансовые активы.

Позднее В.К.~Доманским в \cite{bib:domansky07} была исследована модель, в рамках которой цена акции также может принимать два значения $0$ и $1$, но игроки могут делать ставки только из конечного множества $\{i/m, i = \overline{0, m}\},\ m \in \mathbb{N}$.
Данную модель мы будем называть дискретной.
Формально дискретная модель описывается повторяющейся игрой с неполной информацией (см.~\cite{bib:aumann}).
В работе~\cite{bib:domansky07} показано, что последовательность верхних значений $n$-шаговых игр ограничена, что позволяет определить и решить игру с бесконечным количеством шагов.
Установлено, что при применении игроками оптимальных стратегий последовательность ожидаемых ликвидных цен акции образует симметричное случайное блуждание по множеству допустимых ставок с поглощением в крайних точках.
В момент поглощения оценка вторым игроком ликвидной цены акции совпадает с истинным значением этой цены.
В этот момент торги могут быть остановлены, так как последующий выигрыш первого игрока равен нулю.

%
Для игр с конечным количеством шагов аналитические решения получены только в частных случаях: М.С.~Сандомирской и В.К.~Доманским в \cite{bib:sandomirskaya12} найдено решение одношаговой игры при произвольном натуральном значении $m$, В.Л.~Крепс в \cite{bib:kreps09} построено решение $n$-шаговых игр при $m \leqslant 3$.

В работе \cite{bib:domansky11} рассмотрено обобщение дискретной модели на случай, когда цена акции может принимать любое значение $\s \in S = \mathbb{Z}_+$.
Решение игры с бесконечным количеством шагов найдено в предположении конечности дисперсии цены акции.
Авторами установлено, что в данном случае оптимальная стратегия инсайдера так же порождает симметричное случайное блуждание цен сделок.

В указанных выше работах сделка осуществляется по цене, равной наибольшей предложенной ставке.
Можно, однако, рассмотреть другой механизм, предложенный в \cite{bib:chatterjee83}, и положить цену сделки равной выпуклой комбинации предложенных ставок с коэффициентом $\beta \in [0,1]$, т.е. если игроками были сделаны ставки $i \neq j$, то акция будет продана по цене
\[
  \beta \max(i, j) + (1-\beta) \min(i, j).
\]
Фактически, в \cite{bib:domansky07, bib:domansky11} коэффициент $\beta$ равен $1$.
Обобщение дискретной модели с двумя возможными значениями цены акции на случай $\beta = 1/2$ получено в \cite{bib:pyanykh14}, обобщение на случай произвольного $\beta \in [0, 1]$ построено в \cite{bib:pyanykh16}.

В данной работе это обобщение проведено для дискретной модели со счетным множеством возможных значений цены акции.
Установлено, что оптимальная стратегия инсайдера порождает случайное блуждание последовательности ликвидных цен акции, которое, однако, уже не является симметричным.
Описание возникающих в рассматриваемой модели случайных блужданий дается в п.~\ref{sec:game-solution}.
Появление случайного блуждания в более общей модели подтверждает гипотезу Б.~Де~Мейера и Х.~Салей о возможном стратегическом происхождении случайных флуктуаций цен на фондовых рынках.

Доказательства утверждений вынесены в приложение.

\section{Постановка задачи}
\label{sec:problem-statement}

Пусть множество состояний рынка $S = \Z_+$.
Перед началом игры случай выбирает состояние рынка $\s \in S$ в соответствии с вероятностным распределением $\p = (p^s, \; s \in S)$, имеющим конечную дисперсию состояния $\D \p < \infty$.
На каждом шаге игры $t = \overline{1,n}, \; n \leqslant \infty$, игроки делают ставки $i_t \in I, \, j_t \in J$, где $I = J = \Z_+$.
В силу того, что игрок, предложивший б\'{о}льшую ставку, покупает акцию у другого по цене, равной выпуклой комбинации предложенных ставок, выплата первому игроку в состоянии $s$ равна
\begin{equation*}
  % \label{eq:ps:stage-payoff}
  \as(i_t, j_t) =
  \begin{cases}
    (1-\beta) i_t + \beta j_t - s, &\; i_t < j_t, \\
    0, &\; i_t = j_t, \\
    s - \beta i_t - (1-\beta)j_t, &\; i_t > j_t.
  \end{cases}
\end{equation*}

На шаге $t$ обоим игрокам достаточно принимать в расчет лишь последовательность $(i_1, i_2, \ldots, i_{t-1})$ действий первого игрока на предыдущих ходах.
Это связано с тем, что информация, получаемая вторым игроком относительно состояния $s$, может передаваться лишь посредством действий первого игрока.
Подробное обсуждение данного факта можно найти в \cite{bib:mertens15}.

Обозначим через $\Delta(X)$ совокупность всех вероятностных распределений на
множестве $X$.

\begin{definition}
  Стратегией первого игрока является последовательность ходов $\sigmav = (\sigma_1, \ldots, \sigma_n)$, где $\sigma_t: S \times I^{t-1} \rightarrow \Delta(I)$.
  Множество стратегий первого игрока обозначим $\Sigma$.
\end{definition}

\begin{definition}
  Стратегией второго игрока является последовательность ходов $\tauv = (\tau_1,
  \ldots, \tau_n)$, где $\tau_t: I^{t-1} \rightarrow \Delta(J)$. Множество
  стратегий второго игрока обозначим $\Tau$.
\end{definition}

Таким образом, первый игрок на каждом шаге игры рандомизирует свои действия в зависимости от состояния рынка $s$ и истории своих ставок.
Второй игрок, в свою очередь, не имея информации о состоянии рынка $s$, опирается только на историю ставок инсайдера.

Будем считать, что игроки обладают неограниченными запасами рискового и безрискового активов, т.е. торги не могут прекратиться по причине того, что у одного из игроков закончатся акции или деньги.
Кроме того, предположим, что в начальный момент времени оба игрока имеют нулевые портфели.

При использовании игроками стратегий $\sigmav$ и $\tauv$ ожидаемый выигрыш первого игрока равен
\begin{equation*}
  \K(\p, \sigmav, \tauv) =
  \E_{(\p, \sigmav, \tauv)} \sum_{t=1}^n \as(i_t, j_t),
\end{equation*}
где математическое ожидание берется по мере, индуцированной $\p$, $\sigmav$ и $\tauv$ на множестве $S \times I^n \times J^n$.
Заданную таким образом игру обозначим $\G(\p)$.

\begin{definition}
  Если для некоторых $\sigmav^* \in \Sigma,$ $\tauv^* \in \Tau$ выполняются равенства
  \begin{equation*}
    \inf_{\tauv \in \Tau} \K(\p, \sigmav^*, \tauv) =
    \K(\p, \sigmav^*, \tauv^*) =
    \sup_{\sigmav \in \Sigma} \K(\p, \sigmav, \tauv^*) \eqdef
    \V(\p),
  \end{equation*}
  то говорят, что игра $\G(\p)$ имеет значение $\V(\p)$, а стратегии $\sigmav^*$ и $\tauv^*$
  называются оптимальными.
\end{definition}

Следуя \cite{bib:domansky11}, опишем рекурсивную структуру игры $\G(\p)$.
Представим стратегию первого игрока в виде $\sigmav = (\sigma, \sigmav^i, i \in I)$, где $\sigma$~--- его ход на первом шаге, а $\sigmav^i$ --- его стратегия в игре продолжительности $n-1$ в зависимости от ставки $i$, выбранной им на первом шаге.
Аналогично, стратегию второго игрока представим в виде $\tauv = (\tau, \tauv^i, \; i \in I)$.
%
Далее, обозначим $q^i$ полную вероятность, с которой первый игрок делает ставку $i \in I$, а $\q = (q^i, \; i \in I)$ --- соответствующее распределение.
Также обозначим $p^{s|i}$ апостериорную вероятность состояния $s$ в зависимости от ставки $i$ первого игрока, и $\p^i = (p^{s|i}, \, s \in S)$ --- соответствующее апостериорное распределение.
Тогда для функции выигрыша первого игрока в игре $\G[n](\p)$ справедлива формула
\begin{equation}
  \label{problem:eq:Kn-recurrence}
  \K[n](\p, \sigmav, \tauv) =
  \K[1](\p, \sigma, \tau) +
  \sum_{i \in I} q^i \K[n-1](\p^i, \sigmav^i, \tauv^i).
\end{equation}

\section{Оценка сверху выигрыша первого игрока в игре~$\mathbf{\G[\infty](\p)}$}
Следуя \cite{bib:domansky11}, рассмотрим следующую чистую стратегию второго игрока $\tauv^k = (\tau^k_t,\ t = \overline{1, \infty})$:
\begin{equation*}
  \tau^k_1 = k, \quad
  \tau^k_t(i_{t-1}, j_{t-1}) = \begin{cases}
    j_{t-1} - 1, &\; i_{t-1} < j_{t-1},\\
    j_{t-1}, &\; i_{t-1} = j_{t-1},\\
    j_{t-1}+1, &\; i_{t-1} > j_{t-1}.
  \end{cases}
\end{equation*}
Другими словами, второй игрок делает ставку равную $k$ на первом шаге, а далее либо подражает инсайдеру, либо смещается на единицу к ставке инсайдера предыдущего шага.
Положим $x^+ = \max(0, x), \, x \in \mathbb{R}$.

\begin{lemma}
  \label{upper-bound:lemma:vector-payoffs}
  При применении стратегии $\tauv^k$ в игре $\G(\p)$ второй игрок в состоянии $s$ гарантирует себе проигрыш не более
  \begin{gather*}
    h^s_n(\tauv^k) = \begin{cases}
      \displaystyle \sum_{t=0}^{n-1} (k-s-t-1+\beta)^+, \; s \leqslant k, \\
      \displaystyle \sum_{t=0}^{n-1} (s-k-t-\beta)^+, \; s > k.
    \end{cases} 
  \end{gather*}
  Для любого $s \in S$ последовательность $\left\{ h^s_n(\tauv^k), \; n = \overline{1, \infty}
  \right\}$ не убывает, ограничена сверху и сходится к %
  \begin{equation}
    \label{upper-bound:eq:max-payoff}
    h^s_\infty(\tauv^k) = (s - k + 1 - 2\beta)(s-k)/2.
  \end{equation}
\end{lemma}

Следующие множества распределений зададим ограничениями на математическое ожидание состояния:
\begin{gather*}
  \Theta(x) = \left\{ \p \in \Delta(S): \E \p = x,\ \D \p < \infty \right\}, \\
  \Lambda(x, y) = \left\{ \p' \in \Delta(S): x < \E \p' \leqslant y,\ \D \p < \infty \right\}.
\end{gather*}

Пусть $\tauv^*$ --- стратегия второго игрока, состоящая в применении $\tauv^k$ при $\p
\in \Lambda(k-1+\beta,k+\beta)$.

\begin{theorem}
  \label{upper-bound:theorem}
  При использовании вторым игроком стратегии $\tauv^*$, выигрыш первого игрока в игре
  $\G[\infty](\p)$ ограничен сверху функцией
  \begin{equation*}
    \High(\p) = \inf_{k \in J} \sum_{s \in S} p^s  h^s_\infty(\tauv^k).
  \end{equation*}
  Функция $\High(\p)$ является кусочно-линейной вогнутой с областями линейности $\Lambda(k - 1 + \beta, k + \beta)$ и областями недифференцируемости $\Theta(k+\beta)$ при $k \in S$.
  Для распределений $\p$ с $\E \p = k - 1 + \beta + \eta, \; \eta \in (0, 1]$, ее значение равно
  \begin{equation}
    \label{upper-bound:eq:H(p)}
    \High(\p) = \left( \D \p + \beta(1-\beta) - \eta(1-\eta) \right)/2.
  \end{equation}
\end{theorem}
Заметим, что в данном случае наблюдается сдвиг областей линейности на $\beta$ относительно $\E \p$ в сравнении с областями из \cite{bib:domansky11}.

\section{Оценка снизу выигрыша первого игрока в игре~$\mathbf{\G[\infty](\p)}$}
\label{sec:lower-bound}

Перейдем к описанию стратегии первого игрока, гарантирующей ему выигрыш не менее $\High(\p)$.
Пусть $\sigma^s_i$ --- компонента хода $\sigma$ первого игрока, т.е. вероятность сделать ставку $i$ в состоянии $s$.
По правилу Байеса $\sigma^s_i = p^{s|i} q^i / p^s$.
В частности, справедливы равенства $\sum_{s \in S} \sigma^s_i p^s = q^i,\ i \in I$.
Таким образом, ход $\sigma$ первого игрока можно определить, задав следующие параметры: полные вероятности $q^i$ сделать ставку $i$ и апостериорные вероятности $p^{s|i}$ для $i \in I$.
Тогда его одношаговый выигрыш выражается следующим образом:
\begin{equation}
  \label{lower-bound:eq:K1(q,pi)}
  \K[1](\p, \sigma, j) = \sum_{i \in I} \sum_{s \in S} q^i p^{s|i} \as(i, j).
\end{equation}

Обозначим $\Low[n](\p, \sigmav)$ гарантированный выигрыш первого игрока, использующего стратегию $\sigmav$ в игре $\G[n](\p)$, т.е.
\[
  \Low[n](\p, \sigmav) = \inf_{\tauv \in \Tau} \K[n](\p, \sigmav, \tauv).
\]

\begin{lemma}
  \label{lower-bound:lemma:convex-combination}
  Пусть $\p_1, \p_2$ --- распределения с конечной дисперсией, $\sigmav_1, \sigmav_2 \in \Sigma$ --- стратегии первого игрока.
  Тогда для $\p = \lambda \p_1 + (1-\lambda) \p_2,\ \lambda \in [0, 1],$ найдется такая стратегия $\sigmav_c$, что
  \[
    \Low[n](\p, \sigmav_c) \geqslant
    \lambda \Low[n](\p_1, \sigmav_1) + (1-\lambda) \Low[n](\p_2, \sigmav_2).
  \]
\end{lemma}

Обозначим $e^s$ вырожденное вероятностное распределение с носителем в точке $s$.
Также обозначим $\p^x(l, r) \in \Theta(x)$ распределение с математическим ожиданием $x$ и носителем $\{l, r\}$, где $l<r$.
При этом распределении вероятности реализации состояний $l$ и $r$ равны $(r-x)/(r-l)$ и $(x-l)/(r-l)$, соответственно, а дисперсия
\[
  \D \p^x(l, r) = (x - l)(r - x).
\]
Как показано в \cite{bib:domansky11}, любое распределение $\p = (p^s,\ s \in S) \in \Theta(x)$ может быть представлено в виде выпуклой комбинации распределений с двухточечным носителем следующим образом:
\begin{gather}
  \label{lower-bound:eq:prob-decomp-sum}
  \p = p^x e^x + \sum_{r=x+1}^\infty \sum_{l=0}^{x-1} \alpha_{l,r}(\p) p^x(l, r),\\
  \label{lower-bound:eq:prob-decomp-coeff}
  \alpha_{l,r}(\p) = (r-l) p^l p^r / \sum_{t=0}^{x-1} p^t (x-t).
\end{gather}

Множество $\Theta(x)$ является замкнутым выпуклым подмножеством банахова пространства $\LL$ последовательностей $(l^s,\ s \in S)$ с нормой $\norm{l} = \sum_{s = 0}^\infty s^2 |l^s|$.

\begin{lemma}
  Пусть последовательность $\{l_k\} \subset \LL$ такая, что для любых $s \in S$ и $k \geqslant 1$ верно $l_k^s \geqslant 0,\ l_k^s \leqslant l_{k+1}^s$.
  Тогда если существует ее сходящаяся по норме подпоследовательность $\{l_{k_j}\}$, то и сама последовательность $\{l_k\}$ сходится по норме.
\end{lemma}

\begin{lemma}
  \label{lower-bound:lemma:decomp-convergence}
  Для любого распределения $\p \in \Theta(x)$ ряд в разложении (\ref{lower-bound:eq:prob-decomp-sum}) сходится к $\p$ по норме.
\end{lemma}

Из теоремы~\ref{upper-bound:theorem}, леммы~\ref{lower-bound:lemma:convex-combination} и леммы~\ref{lower-bound:lemma:decomp-convergence} следует, что для доказательства совпадения верхней и нижней оценок выигрыша в игре $\G[\infty](\p)$ можно ограничиться рассмотрением только распределений $\p~\in~\Theta(k + \beta), \; k \in S$.

Таким образом, для распределения вида $\p = \p^{k+\beta}(l, r),\ k \in S$ необходимо построить стратегию первого игрока $\sigmav^*$, для которой $\Low[\infty](\p, \sigmav^*) = \High[\infty](\p)$.
Отсюда будет следовать, что $\V[\infty](\p)~=~\High[\infty](\p)$, а $\sigmav^*$ и $\tauv^*$ --- оптимальные стратегии игроков в игре $\G[\infty](\p)$, где $\p = \p^{k+\beta}(l, r)$.

Обозначим $\sigmak_k$ ход первого игрока, состоящий в выборе ставки из множества $\{k, k+1\}$.
Ход $\sigmak_k$ определяется заданием полных вероятностей $q^k, q^{k+1}$ и
апостериорных распределений $\p^k, \p^{k+1}$, причем $q^k + q^{k+1} = 1$.
Следующая лемма является обобщением утверждения 2 из \cite{bib:pyanykh16}.
\begin{lemma}
  \label{lower-bound:lemma:stage-payoff}
  При использовании $\sigmak_k$ одношаговый выигрыш первого игрока равен
  \begin{equation*}
    \small
    \K[1](\p, \sigmak_k, j) = \begin{cases}
      \E \p - \beta k - (1-\beta) j - \beta q^{k+1}, &\; j < k, \\
      (\E \p^{k+1} - k - \beta) q^{k+1}, &\; j = k, \\
      (k + \beta - \E \p^k) q^k, &\; j = k+1, \\
      (1-\beta) k + \beta j - \E \p + (1-\beta) q^{k+1}, &\; j > k + 1.
    \end{cases}
  \end{equation*}
\end{lemma}

Определим стратегию $\sigmav^*$ первого игрока в игре $\G[\infty](\p)$.
Введем множество распределений
\begin{equation*}
  P(l,r) = \left\{
    \p^k(l, r), \, \p^{s+\beta}(l, r), \, k = \overline{l,r}, s = \overline{l,r-1}
  \right\}.
\end{equation*}
При $\p \in P(l,r)$ первый ход стратегии $\sigmav^*$ определяется следующим образом.
Если $\p = \p^l(l,r)$ или $\p = \p^r(l,r)$, то первый игрок использует ставки $l$ и $r$, соответственно, с вероятностью 1.
В противном случае он использует $\sigmak_k$ с параметрами из таблицы~\ref{tab:insider-strategy}.

\begin{table}[htbp]\centering
  \caption{Параметры стратегии $\sigmav^*$ при $\p \in P(l, r)$}
  \label{tab:insider-strategy}
  \begin{tabular}{|c|c|c|c|c|}
    \hline
    $\p$               & $q^k$   & $q^{k+1}$ & $\p^{k}$             & $\p^{k+1}$         \\ \hline
    $\p^k(l, r)$         & $\beta$   & $1-\beta$   & $\p^{k-1+\beta}(l, r)$ & $\p^{k+\beta}(l, r)$ \\ \hline
    $\p^{k+\beta}(l, r)$ & $1-\beta$ & $\beta$     & $\p^k(l, r)$           & $\p^{k+1}(l, r)$     \\
    \hline
  \end{tabular}
\end{table}

На последующих шагах игры таким образом определенный ход применяется рекурсивно для соответствующих значений апостериорных вероятностей.

Обозначим $L^x_n(\sigmav) = \Low[n](\p^x(l,r), \sigmav),\ \sigmav \in \Sigma$.
Следующая теорема является обобщением утверждения 5 из \cite{bib:pyanykh16}.
\begin{theorem}
  \label{lower-bound:theorem}
  Пусть $\beta \in (0, 1)$.
  При использовании стратегии $\sigmav^*$ в игре $\G[\infty](\p)$ для
  распределения %
  $\p \in P(l,r)$ %
  гарантированный выигрыш первого игрока удовлетворяет следующей системе:
  \begin{subequations}
    \label{lower-bound:eq:Linf-recurrence}
    \begin{multline}
      L^k_\infty(\sigmav^*) =
      \beta L^{k-1+\beta}_\infty(\sigmav^*) + \\
      + (1-\beta) L^{k+\beta}_\infty(\sigmav^*),\ k = \overline{l + 1, r - 1},
    \end{multline}
    \begin{multline}
      L^{k+\beta}_\infty(\sigmav^*) =
      \beta(1-\beta) + (1-\beta) L^k_\infty(\sigmav^*) +\\
      +\beta L^{k+1}_\infty(\sigmav^*),\ k = \overline{l, r - 1}.
    \end{multline}
    \begin{equation}
      L^l_\infty(\sigmav^*) = L^r_\infty(\sigmav^*) = 0.
    \end{equation}
  \end{subequations}
  Ее решение дает нижнюю оценку выигрыша первого игрока, равную
  \begin{equation*}
    \label{lower-bound:eq:Linf-recurrence-solution}
    \Low(\p^{k+\beta}(l, r), \sigmav^*) = ((r-k-\beta)(k+\beta-l) + \beta(1-\beta))/2.
  \end{equation*}
\end{theorem}
Поскольку
$
  \D \p^{k+\beta}(l, r) = (r-k-\beta)(k+\beta-l),
$
а распределение $\p^{k+\beta}(l, r)$ удовлетворяет условию теоремы~\ref{upper-bound:theorem} с $\eta = 1$, выражения для $\High[\infty](\p^{k+\beta}(l, r))$ и $\Low[\infty](\p^{k+\beta}(l, r), \sigmav^*)$ совпадают.

Для распределений $\p \in \Theta(k),\ k \in S$ стратегию $\sigmav^*$ определим следующим образом.
Если реализуется состояние $s = k$, то гарантированный выигрыш первого игрока не превышает $0$, и стратегия $\sigmav^*$ прекращает игру.
В противном случае игрок использует конструкцию леммы~\ref{lower-bound:lemma:convex-combination} для построения стратегии, соответствующей выпуклой комбинации распределений $\p^k(l, r)$ в разложении $\p$.
Первый ход такой стратегии использует две ставки $k$ и $k+1$ с полными вероятностями $(1-p^k)\beta$ и $(1-p^k)(1-\beta)$ соответственно.
Апостериорные вероятностные распределения при этом даются следующими формулами:
\begin{gather*}
  \p^k = \frac{1}{1-p^k} \sum_{r=k+1}^\infty \sum_{l=0}^{k-1} \alpha_{l,r}(\p) \p^{k-1}(l, r),\\
  \p^{k+1} = \frac{1}{1-p^k} \sum_{r=k+1}^\infty \sum_{l=0}^{k-1} \alpha_{l,r}(\p) \p^{k+1}(l, r).
\end{gather*}
Для распределений $\p$ со счетным носителем сходимость данных рядов устанавливается аналогично доказательству леммы~\ref{lower-bound:lemma:decomp-convergence}.


Аналогичные рассуждения справедливы и для распределений $\p \in \Theta(k+\beta) \cup \Lambda(k, k+\beta),\ k \in S$.

\section{Решение игры $\mathbf{\G[\infty](p)}$}
\label{sec:game-solution}

Подчеркнем, что приведенная в п.~\ref{sec:lower-bound} стратегия инсайдера $\sigma^*$ определена только при $\beta \in (0, 1)$.

Нетрудно проверить справедливость следующего равенства:
\begin{equation*}
  a^{r, \beta}(i, j) = a^{l, 1-\beta}(r+l-i, r+l-j).
\end{equation*}
Из него вытекает, что решение игры $\G[\infty](\p^x(l, r))$ сводится к решению игры $G^{1-\beta}_\infty(\p^{l+r-x}(l,r))$.
При этом ставки, используемые в соответствующих смешанных стратегиях инсайдера, симметричны относительно точки $(l+r)/2$.
Аналогичные рассуждения справедливы для игры $\G[\infty](\p)$ при любом распределении $\p$.

Оптимальная стратегия $\sigmav^*$ инсайдера в игре $\G[\infty](\p)$ при $\beta~=~1$ найдена в~\cite{bib:domansky11}.
Решение $\G[\infty](\p)$ при $\beta = 0$ может быть получено при помощи описанной выше конструкции из решения $\G[\infty](\p)$ при $\beta = 1$.
Таким образом, при любом $\beta \in [0, 1]$ справедлива следующая
\begin{theorem}
  \label{solution:theorem}
  Игра $\G[\infty](\p)$ имеет значение
  \[
    \V[\infty](\p) = \High(\p) = \Low(\p),
  \]
  а $\sigmav^*$ и $\tauv^*$ --- оптимальные стратегии игроков.
\end{theorem}

\begin{figure}[tbh]
  \small
  \centering
  \begin{tikzpicture}
    [
    auto,node distance=1.25cm,
    trans/.style={->,shorten >=1pt,>=stealth',semithick},
    state/.style={shape=circle,draw,minimum size=2mm}
    ]
    \node[state,label={$\p^l(l,r)$}] (p0) {};
    \node[state,right=of p0,label={$\p^{l+\beta}(l,r)$}] (p1) {}; 
    \node[state,right=of p1,label={$\p^{l+1}(l,r)$}] (p2) {};
    \node[right=of p2] (others) {$\ldots$};
    \node[state,right=of others,label={$\p^{r-1+\beta}(l,r)$}] (p2mm1) {};
    \node[state,right=of p2mm1,label={$\p^r(l,r)$}] (p2m) {};
    
    \path [trans]
    (p0) edge [loop left,min distance=10mm,out=205,in=155] node {$1$} (p0)
    (p1) edge[bend right] node[below] {$1-\beta$} (p0)
    (p1) edge[bend left] node[below] {$\beta$} (p2)
    (p2) edge[bend left] node[below] {$\beta$} (p1)
    (p2) edge[bend right] node[below] {$1-\beta$} (others)
    (others) edge[bend left] node[below] {$\beta$} (p2mm1)
    (p2mm1) edge[bend left] node[below] {$1-\beta$} (others)
    (p2mm1) edge[bend right] node[below] {$\beta$} (p2m)
    (p2m) edge[loop right,min distance=10mm,out=25,in=-25] node {$1$} (p2m)
    ;
  \end{tikzpicture}
  \caption[Последовательность апостериорных вероятностей]{Случайное блуждание последовательности апостериорных вероятностей, порожденное $\sigmav^*$}
  \label{fig:posterior-1}
\end{figure}

Применение первым игроком стратегии $\sigmav^*$ порождает случайное блуждание последовательности апостериорных вероятностей, изображенное на рисунке~\ref{fig:posterior-1}, которое в отличие от \cite{bib:domansky11} происходит по более широкому множеству и уже не является симметричным, за исключением случая $\beta = 1/2$.

В дополнение к стратегии $\sigmav^*$ построим еще одну оптимальную стратегию инсайдера.
Введем множество распределений %
\begin{equation*}
  P'(l,r) =
  \{\p^l(l, r), \p^r(l, r)\}
  \cup
  \left\{
    \p^{k+\beta}(l, r), \, k = \overline{l, r-1}
  \right\}.
\end{equation*}
При $\p \in P'(l,r)$ первый ход стратегии $\xiv^*$ определяется следующим образом.
Если $\p = \p^l(l,r)$ или $\p = \p^r(l,r)$, то первый игрок использует ставки $l$ и $r$, соответственно, с вероятностью 1.
В противном случае он использует $\sigmak_k$ с параметрами из таблицы~\ref{tab:insider-strategy2}.
\begin{table}[htbp]\centering
  \caption{Параметры стратегии $\xiv^*$ при $\p \in P(l, r)$}
  \label{tab:insider-strategy2}
  \begin{tabular}{|c|c|c|c|c|}
    \hline
    $\p$               & $q^k$   & $q^{k+1}$ & $\p^{k}$             & $\p^{k+1}$         \\ \hline
    &&&&\\[-1em]
    $\p^{l+\beta}(l, r)$ & $\frac{1}{1+\beta}$ & $\frac{\beta}{1+\beta}$ & $\p^l(l, r)$ & $\p^{l+1+\beta}(l, r)$\\
    &&&&\\[-1em]
    \hline
    &&&&\\[-1em]
    %
    $\p^{r-1+\beta}(l, r)$ & $\frac{1-\beta}{2-\beta}$ & $\frac{1}{2-\beta}$ & $\p^{r-1}(l, r)$ & $\p^r(l, r)$\\
    &&&&\\[-1em]
    \hline
    &&&&\\[-1em]
    %
    $\p^{k+\beta}(l, r)$ & $\frac{1}{2}$ & $\frac{1}{2}$ & $\p^{k-1+\beta}(l, r)$ & $\p^{k+1+\beta}(l, r)$\\
    \hline
  \end{tabular}
\end{table}

Для остальных распределений $\p$ стратегия $\xiv^*$ определяется конструкцией леммы~\ref{lower-bound:lemma:convex-combination}.

Использование стратегии $\xiv^*$ порождает случайное блуждание последовательности апостериорных вероятностей, изображенное на рисунке~\ref{fig:posterior-2}.
Данное блуждание симметрично с вероятностями перехода в соседние состояния равными $1/2$, симметрия нарушается только в крайних и соседних к ним состояниях.

\begin{figure}[tbh]
  \small
  \centering
  \begin{tikzpicture}
    [
    auto,yscale=1.1,node distance=1.25cm,
    trans/.style={->,shorten >=1pt,>=stealth',semithick},
    state/.style={shape=circle,draw,minimum size=2mm}
    ]
    \node[state,label={$\p^l(l,r)$}] (p0) {};
    \node[state,right=of p0,label={$\p^{l+\beta}(l,r)$}] (p1) {}; 
    \node[state,right=of p1,label={$\p^{l+1+\beta}(l,r)$}] (p2) {};
    \node[right=of p2] (others) {$\ldots$};
    \node[state,right=of others,label={$\p^{r-1+\beta}(l,r)$}] (p2mm1) {};
    \node[state,right=of p2mm1,label={$\p^r(l,r)$}] (p2m) {};
    
    \path [trans]
    (p0) edge [loop left,min distance=10mm,out=205,in=155] node {$1$} (p0)
    (p1) edge[bend right] node[below] {$\frac{1}{1+\beta}$} (p0)
    (p1) edge[bend left] node[below] {$\frac{\beta}{1+\beta}$} (p2)
    (p2) edge[bend left] node[below] {$\frac{1}{2}$} (p1)
    (p2) edge[bend right] node[below] {$\frac{1}{2}$} (others)
    (others) edge[bend left] node[below] {$\frac{1}{2}$} (p2mm1)
    (p2mm1) edge[bend left] node[below] {$\frac{1-\beta}{2-\beta}$} (others)
    (p2mm1) edge[bend right] node[below] {$\frac{1}{2-\beta}$} (p2m)
    (p2m) edge[loop right,min distance=10mm,out=25,in=-25] node {$1$} (p2m)
    ;
  \end{tikzpicture}
  \caption[Последовательность апостериорных вероятностей]{Случайное блуждание последовательности апостериорных вероятностей, порожденное $\xiv^*$}
  \label{fig:posterior-2}
\end{figure}

Из леммы~\ref{lower-bound:eq:K1(q,pi)} можно вывести, что
\begin{gather*}
  L^{l+\beta}_1(\xiv^*) = \frac{\beta}{1+\beta},\quad
  L^{r-1+\beta}_1(\xiv^*) = \frac{1-\beta}{2-\beta},\\
  L^{k+\beta}_1(\xiv^*) = \frac{1}{2},\ k = \overline{l+1,r-2}.
\end{gather*}
Отсюда при использовании стратегии $\xiv^*$ в игре $\G[\infty](\p)$ для распределения %
$\p \in P'(l,r)$ %
гарантированный выигрыш первого игрока удовлетворяет следующей системе:
\begin{subequations}
  \label{lower-bound:eq:Linf-recurrence-2}
  \begin{multline}
    L^{l+\beta}_{\infty,r}(\xiv^*) =
    \frac{\beta}{1+\beta} + \frac{1}{1+\beta} L^l_{\infty}(\xiv^*) + \frac{\beta}{1+\beta} L^{l+1+\beta}_{\infty}(\xiv^*),
  \end{multline}
  \begin{multline}
    L^{r-1+\beta}_{\infty}(\xiv^*) =
    \frac{1-\beta}{2-\beta} + \frac{1-\beta}{2-\beta} L^{r-2+\beta}_{\infty}(\xiv^*) + \frac{1}{2-\beta} L^r_{\infty}(\xiv^*),
  \end{multline}
  \begin{multline}
    L^{k+\beta}_{\infty}(\xiv^*) =
    \frac{1}{2} + \frac{1}{2} L^{k-1+\beta}_{\infty}(\xiv^*) + \\
    + \frac{1}{2} L^{k+1+\beta}_{\infty}(\xiv^*),\ k \in \overline{l+1, r-2},
  \end{multline}
  \begin{equation}
    L^l_{l,r} = L^r_{l,r} = 0.
  \end{equation}
\end{subequations}

Нетрудно проверить, что подстановкой
\[
\High(\p^{k+\beta}(l,r)) = \frac{(r-k-\beta)(k+\beta-l) + \beta(1-\beta)}{2}
\] 
вместо $L^{k+\beta}_{l,r}$ данные равенства обращаются в тождества.
Отсюда, как и для стратегии $\sigmav^*$, следует, что стратегия $\xiv^*$ является оптимальной.

Отметим, что в отличие от стратегии $\sigmav^*$ стратегия $\xiv^*$ определена при $\beta \in [0, 1]$ и совпадает с оптимальной стратегией инсайдера из \cite{bib:domansky11} при $\beta = 1$.
При этом обе стратегии $\sigmav^*$ и $\xiv^*$ порождают существенно различные случайные блуждания апостериорных вероятностей.

\appendix

\begin{proof}\underline{[Лемма~\ref{upper-bound:lemma:vector-payoffs}]}
  Проведем доказательство индукцией по $n$ для случая $s > k$.
  При $n = 1$ оптимальный ответ первого игрока на $\tauv^k$ будет $i = k + 1$.
  Тогда его выигрыш в игре $\G[1](\p)$ равен
  \begin{equation*}
    h^s_1(\tauv^k) = s - \beta(k+1) - (1-\beta)k = s - k - \beta.
  \end{equation*}
  База индукции проверена.
  Предположим, что утверждение верно при $n \leqslant N$.
  При $n = N + 1$ первый игрок имеет два разумных ответа на $\tauv^k$: ставка $i = k + 1$, что соответствует покупке акции по наименьшей возможной цене, и ставка $i = k - 1$, что соответствует продаже акции за наибольшую возможную цену.
  Найдем оценки выигрыша в каждом из случаев.
  Для $i = k + 1$ выигрыш первого игрока не превосходит величины
  \begin{equation*}
    s - k - \beta + h^s_N(\tauv^{k+1}) = \sum_{t=0}^N(s-k-t-\beta)^+.
  \end{equation*}
  Аналогично для $i = k - 1$ тот же выигрыш не превосходит
  \begin{equation*}
    \beta k + (1-\beta)(k-1) - s + h^s_N(\tauv^{k-1}) = \sum_{t=0}^{N-2}(s-k-t-\beta)^+.
  \end{equation*}
  При $s \leqslant k$ формула для $h^s_n(\tauv^k)$ доказывается аналогично.
  Сходимость $h^s_n(\tauv^k)$ к $h^s_\infty(\tauv^k)$ следует из равенства
  $h^s_n(\tauv^k) = h^s_{n+1}(\tauv^k)$ при $n \geqslant s - k$.
\end{proof}

\begin{proof}\underline{[Теорема~\ref{upper-bound:theorem}]}
  Воспользовавшись \eqref{upper-bound:eq:max-payoff}, получим
  \begin{equation}
    \label{upper-bound:theorem:eq:1}
    \begin{gathered}
    \sum_{s \in S} p^s h^s_\infty(\tauv^j) = \bigl(
      j^2 + (2\beta - 1 - 2 \E \p)j - \\
      - (2\beta - 1) \E \p + \E \p^2 
    \bigr)/2.
    \end{gathered}
  \end{equation}
  
  Квадратичная функция $f(x) = x^2 + (2\beta - 1 - 2\E \p)x$ достигает минимума
  при $x = \E \p - \beta + 1/2$. Отсюда при $\p \in \Lambda(k - 1 + \beta, k +
  \beta)$ выражение \eqref{upper-bound:theorem:eq:1} достигает минимума при $j =
  k$. Равенство \eqref{upper-bound:eq:H(p)} проверяется непосредственной
  подстановкой $\E \p = k - 1 + \beta + \xi$ в \eqref{upper-bound:theorem:eq:1}.
\end{proof}

\begin{proof}\underline{[Лемма~\ref{lower-bound:lemma:convex-combination}]}
  Докажем следующее утверждение: найдется такая стратегия $\sigmav_c = (\sigma_c, \sigmav_c^i) \in \Sigma$, что при всех $\tauv \in \Tau$ справедливо неравенство
  \begin{equation}
    \label{lower-bound:lemma:convex-combination:eq:1}
    \K[n](\p, \sigmav_c, \tauv) =
    \lambda \K[n](\p_1, \sigmav_1, \tauv) +
    (1-\lambda)\K[n](\p_1, \sigmav_2, \tauv).
  \end{equation}
  Доказательство проведем по индукции.
  Пусть $\q_h = (q_h^i,\ i \in I)$ и $\p_h^i = (\p_h^{s|i},\ s \in S)$ --- векторы полных и апостериорных вероятностей, соответствующие первому ходу $\sigma_h$ стратегии $\sigmav_h,\ h = 1, 2$.
  Определим первый ход $\sigma_c$ стратегии $\sigmav_c$ параметрами
  \begin{equation*}
    % \label{lower-bound:eq:q-pi}
    \begin{gathered}
      q^i = \lambda q^i_1 + (1-\lambda) q^i_2,\ i \in I,\\
      p^{s|i} = \left(
        \lambda q^i_1 p^{s|i}_1 + (1-\lambda) q^i_2 p^{s|i}_2
      \right) / q^i,\ i \in I,\ s \in S.
    \end{gathered}
  \end{equation*}
  Подставив эти выражения в \eqref{lower-bound:eq:K1(q,pi)}, для любого $j \in J$ имеем:
  \begin{gather*}
    \K[1](\p, \sigmav_c, j) =
    \sum_{i \in I}\sum_{s \in S} q^i p^{s|i} \as(i, j) = \\
    \sum_{i \in I, \, s \in S}
    q^i \frac{(\lambda q^i_1 p^{s|i}_1 + (1-\lambda) q^i_2 p^{s|i}_2)}{q^i} \as(i,j) = \\
    = \lambda \K[1](\p_1, \sigmav_1, j) +
    (1-\lambda)\K(\p_2, \sigmav_2, j).
  \end{gather*}
  Осредняя это равенство по произвольному $\tau \in \Delta(J)$, получим \eqref{lower-bound:lemma:convex-combination:eq:1} при $n = 1$.
  Предположим, что утверждение имеет место при любых $n \leqslant N$.
  Поскольку для каждого $i \in I$
  \[
    \p^i = \frac{\lambda q_1^i}{q^i} \p_1^i + \frac{(1-\lambda)q_2^i}{q^i} \p_2^i,
  \]
  для $\sigmav_1^i,\ \sigmav_2^i$ найдется такая стратегия первого игрока $\sigmav_c^i$ в игре $\G[N](\p^i)$, что для любой стратегии $\tauv^i$
  \begin{equation*}
    \begin{gathered}
      \K[N](\p^i, \sigmav^i_c, \tau^i) =
      \frac{\lambda q^i_1}{q^i} \K[N](\p^i_1, \sigmav^i_1, \tauv^i) +
      \frac{(1-\lambda) q^i_2}{q^i} \K[N](\p^i_2, \sigmav^i_2, \tauv^i).
    \end{gathered}
  \end{equation*}
  В результате для $\sigmav_c = (\sigma_c, \sigma_c^i) \in \Sigma$ и любой стратегии $\tauv = (\tau, \tau^i) \in \Tau$ в игре $\G[N+1](\p)$ справедливо равенство
  \begin{gather*}
    \K[N+1](\p, \sigmav_c, \tauv) =
    \K[1](\p, \sigmav_c, \tauv) +
    \sum_{i \in I} q_i \K[N](\p^i, \sigmav^i_c, \tau^i) = \\
    = \lambda \K[1](\p_1, \sigma_1, \tau) +
    (1-\lambda) \K[1](\p_2, \sigma_2, \tau) + \\
    + \sum_{i \in I} q^i \left(
      \frac{\lambda q^i_1}{q^i} \K[N](\p^i_1, \sigmav^i_1, \tauv^i) +
      \frac{(1-\lambda) q^i_2}{q^i} \K[N](\p^i_2, \sigmav^i_2, \tauv^i)
    \right) = \\
    = \lambda \K[N+1](\p_1, \sigmav_1, \tauv) +
    (1-\lambda)\K[N+1](\p_1, \sigmav_2, \tauv).
  \end{gather*}
  Утверждение доказано.
  Из него следует
  \begin{multline*}
    \Low[n](\p, \sigmav_c) = \inf_{\tauv \in \Tau} \K[n](\p, \sigmav_c, j) \geqslant
    \lambda \min_{\tauv \in \Tau} \K[n](\p, \sigmav_1, j) + \\
    + (1-\lambda) \min_{\tauv \in \Tau} \K[n](\p, \sigmav_2, j) =
    \lambda \Low[n](\p_1, \sigmav_1) + (1-\lambda) \Low[n](\p_2, \sigmav_2).
  \end{multline*}
\end{proof}

\begin{proof}\underline{[Лемма~\ref{lower-bound:lemma:stage-payoff}]}
  Можно показать, что
  \begin{equation*}
    \as(\sigmak_k, j) = \begin{cases}
      s - \beta k - (1-\beta) j - \beta \sigma^s_{k+1}, &\; j < k,\\
      (s - k - \beta) \sigma^s_{k+1}, &\; j = k,\\
      (k + \beta - s) \sigma^s_k, &\; j = k+1,\\
      (1-\beta) k + \beta j - s + (1-\beta) \sigma^s_{k+1}, &\; j > k + 1.
    \end{cases}
  \end{equation*}
  Отсюда непосредственно следует утверждение леммы.
\end{proof}

\begin{proof}\underline{[Теорема~\ref{lower-bound:theorem}]}
  Для $\p \in P(l,r)$ стратегия $\sigmav^*$ определяется аналогично работе \cite{bib:pyanykh16} с заменой $0$ и $m$ на $l$ и $r$ соответственно.
  Из леммы~\ref{lower-bound:eq:K1(q,pi)} нетрудно вывести, что
  \begin{equation*}
    L^k_1(\sigmav^*) = 0,\quad
    L^{k+\beta}_1(\sigmav^*) = \beta(1-\beta).
  \end{equation*}
  Для $k = \overline{l+1,r-1}$ имеем
  \begin{multline*}
    L^k_\infty(\sigmav^*) = L^k_1(\sigmav^*) + q^k L^{k-1+\beta}_\infty(\sigmav^*) + q^{k+1} L^{k+\beta}_\infty(\sigmav^*) = \\
    = \beta L^{k-1+\beta}_\infty(\sigmav^*) + (1-\beta) L^{k+\beta}_\infty(\sigmav^*).
  \end{multline*}
  Аналогично для $k = \overline{l, r-1}$ получаем
  \begin{multline*}
    L^{k+\beta}_\infty(\sigmav^*) = L^{k+\beta}_1(\sigmav^*) + q^k L^k_\infty(\sigmav^*) + q^{k+1} L^{k+1}_\infty(\sigmav^*) = \\
    = \beta(1-\beta) + (1-\beta) L^k_\infty(\sigmav^*) + \beta L^{k+1}_\infty(\sigmav^*).
  \end{multline*}
  Полученная система \eqref{lower-bound:eq:Linf-recurrence} является системой с трехдиагональной матрицей и решается методом прогонки (см. \cite{bib:pyanykh16}).
\end{proof}

\begin{thebibliography}{10}
\bibitem{bib:domansky11}%
  {\MakeUppercase{Доманский В.К., Крепс В.Л.}} \textit{Теоретико-игровая модель биржевых торгов: стратегические аспекты формирования цен на фондовых рынках} // Журнал Новой экономической ассоциации. -- 2011. -- Вып. 11. -- C. 39--62.

\bibitem{bib:kreps09}%
  {\MakeUppercase{Крепс В.Л.}} \textit{Повторяющиеся игры, моделирующие биржевые
    торги, и возвратные последовательности} // Известия РАН. Теория и системы управления. -- 2009. -- № 4. -- С. 109--120.

\bibitem{bib:pyanykh14}%
  {\MakeUppercase{Пьяных А.И.}} \textit{Об одной модификации модели биржевых торгов с инсайдером} // Математическая теория игр и ее приложения. -- 2014. -- Т. 6, №4. - С. 68--84.

\bibitem{bib:pyanykh16}%
  {\MakeUppercase{Пьяных А.И.}} \textit{Многошаговая модель биржевых торгов с
    асимметричной информацией и элементами переговоров} // %
  Вестн. Моск. ун-та. Сер.15. Вычисл. матем. и киберн. -- 2016. -- №1. -- С.
  34—-40.

\bibitem{bib:sandomirskaya12}%
  {\MakeUppercase{Сандомирская М.С., Доманский В.К.}} \textit{Решение
    одношаговой игры биржевых торгов с неполной информацией} // %
  Математическая теория игр и ее приложения. -- 2012. -- Т. 4, №1. -- С. 32--54.

\bibitem{bib:aumann}%
  {\MakeUppercase{Aumann R.J., Maschler M.B.}} \textit{Repeated Games with
    Incomplete Information}. %
  Cambridge, Mass.: The MIT Press, 1995.

\bibitem{bib:chatterjee83}%
  {\MakeUppercase{Chatterjee K., Samuelson W.}} \textit{Bargaining under
    Incomplete Information} // %
  Operations Research. -- 1983. -- Vol. 31, № 5. -- P. 835--851.

\bibitem{bib:demeyer02}%
  {\MakeUppercase{De Meyer B.}} \textit{On the strategic origin of Brownian motion in finance} // International Journal of Game Theory. -- 2002. -- Vol. 31, №2. -- P. 285--319. 

\bibitem{bib:domansky07}%
  {\MakeUppercase{Domansky V.}} \textit{Repeated games with asymmetric
    information and random price fluctuations at finance markets} // %
  International Journal of Game Theory. -- 2007. -- Vol. 36, № 2. -- P. 241--257.

\bibitem{bib:mertens15}
  {\MakeUppercase{Mertens J.--F., Sorin S., Zamir S.}} \textit{Repeated games}. Cambridge: Cambridge University Press, 2015.
\end{thebibliography}

\makeenginfo
\makeauxinfo
\end{document}
